{% extends "base.html" %}

{% block title %}{% if link %}Linki D√ºzenle{% else %}Yeni Link{% endif %} ‚Äì Support Hub{% endblock %}
{% block page_title %}{% if link %}‚úèÔ∏è Linki D√ºzenle{% else %}‚ûï Yeni Link Ekle{% endif %}{% endblock %}

{% block topbar_actions %}
    <a href="{{ url_for('links_list') }}" class="btn btn-secondary">‚Üê Linklere D√∂n</a>
{% endblock %}

{% block extra_styles %}
<style>
    .form-card {
        max-width: 680px;
        background: var(--white);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 32px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .form-row { display: grid; grid-template-columns: 1fr auto; gap: 14px; align-items: start; }

    .form-actions {
        display: flex; gap: 10px; justify-content: flex-end; margin-top: 24px;
        padding-top: 20px; border-top: 1px solid var(--border);
    }

    .url-preview {
        margin-top: 6px;
        font-size: 12px;
        color: var(--primary-dark);
        word-break: break-all;
    }
</style>
{% endblock %}

{% block content %}
<div class="form-card">
    <form method="post"
          action="{% if link %}{{ url_for('link_edit', link_id=link['id']) }}{% else %}{{ url_for('link_new') }}{% endif %}">

        <div class="form-row">
            <div class="form-group">
                <label for="title">Ba≈ülƒ±k <span style="color:var(--error)">*</span></label>
                <input type="text" id="title" name="title" class="form-control"
                       placeholder="√ñrn: Kullanƒ±cƒ± Servisi Swagger" value="{{ title }}"
                       required maxlength="200">
            </div>
            <div class="form-group" style="min-width:160px;">
                <label for="category">Kategori</label>
                <select id="category" name="category" class="form-control">
                    {% for cat in categories %}
                        <option value="{{ cat }}" {% if category == cat %}selected{% endif %}>{{ cat }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="url">URL <span style="color:var(--error)">*</span></label>
            <input type="url" id="url" name="url" class="form-control"
                   placeholder="https://" value="{{ url }}" required maxlength="2000">
            <p class="url-preview" id="urlPreview"></p>
        </div>

        <div class="form-group">
            <label for="description">A√ßƒ±klama</label>
            <textarea id="description" name="description" class="form-control"
                      placeholder="Bu linkin kƒ±sa a√ßƒ±klamasƒ±‚Ä¶"
                      style="min-height:100px;">{{ description }}</textarea>
        </div>

        <div class="form-actions">
            <a href="{{ url_for('links_list') }}" class="btn btn-secondary">ƒ∞ptal</a>
            <button type="submit" class="btn btn-primary">
                {% if link %}üíæ G√ºncelle{% else %}‚ûï Ekle{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    const urlInput = document.getElementById('url');
    const urlPreview = document.getElementById('urlPreview');

    function updatePreview() {
        const val = urlInput.value.trim();
        urlPreview.textContent = val ? 'üîó ' + val : '';
    }
    urlInput.addEventListener('input', updatePreview);
    updatePreview();
</script>
{% endblock %}
