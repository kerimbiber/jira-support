{% extends "base.html" %}

{% block title %}Jira BaÄŸlantÄ± Kurulum Rehberi â€“ Destek Merkezi{% endblock %}
{% block page_title %}ğŸ“– Jira BaÄŸlantÄ± Kurulum Rehberi{% endblock %}

{% block topbar_actions %}
    <a href="{{ url_for('jira_settings_view') }}" class="btn btn-primary">
        <span>âš™ï¸</span> BaÄŸlantÄ± AyarlarÄ±
    </a>
{% endblock %}

{% block extra_styles %}
<style>
    .doc-wrap { max-width: 860px; margin: 0 auto; }

    .doc-toc {
        background: var(--white);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px 24px;
        margin-bottom: 28px;
    }
    .doc-toc h3 {
        font-size: 14px;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 12px;
    }
    .doc-toc ol {
        padding-left: 20px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4px 20px;
    }
    .doc-toc li { font-size: 13px; }
    .doc-toc a { color: var(--primary); text-decoration: none; }
    .doc-toc a:hover { text-decoration: underline; }
    @media (max-width: 600px) { .doc-toc ol { grid-template-columns: 1fr; } }

    .doc-section {
        background: var(--white);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 28px 32px;
        margin-bottom: 20px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    }
    @media (max-width: 600px) { .doc-section { padding: 20px; } }

    .doc-section h2 {
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--primary-light);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .doc-section h3 {
        font-size: 15px;
        font-weight: 600;
        color: var(--text-primary);
        margin: 20px 0 10px;
    }

    .doc-section p {
        font-size: 14px;
        color: var(--text-secondary);
        line-height: 1.75;
        margin-bottom: 12px;
    }

    .doc-section ul, .doc-section ol {
        font-size: 14px;
        color: var(--text-secondary);
        line-height: 1.75;
        padding-left: 22px;
        margin-bottom: 12px;
    }
    .doc-section li { margin-bottom: 6px; }

    .step-list { list-style: none; padding-left: 0; }
    .step-list li {
        display: flex;
        gap: 14px;
        margin-bottom: 14px;
        align-items: flex-start;
    }
    .step-num {
        width: 28px; height: 28px;
        background: var(--primary);
        color: #fff;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        font-size: 12px;
        font-weight: 700;
        flex-shrink: 0;
        margin-top: 2px;
    }
    .step-content { flex: 1; }
    .step-content strong {
        display: block;
        font-size: 14px;
        color: var(--text-primary);
        margin-bottom: 3px;
    }
    .step-content span {
        font-size: 13px;
        color: var(--text-secondary);
        line-height: 1.6;
    }

    code {
        background: #f3f4f6;
        border: 1px solid var(--border);
        border-radius: 5px;
        padding: 2px 7px;
        font-family: 'Courier New', monospace;
        font-size: 12.5px;
        color: #374151;
    }

    .code-block {
        background: #1e1b4b;
        color: #c7d2fe;
        border-radius: 10px;
        padding: 16px 20px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        line-height: 1.6;
        margin: 12px 0;
        overflow-x: auto;
    }

    .tip-box {
        background: #eff6ff;
        border: 1px solid #bfdbfe;
        border-radius: 10px;
        padding: 14px 16px;
        font-size: 13px;
        color: #1e40af;
        margin: 14px 0;
        line-height: 1.65;
    }
    .tip-box::before { content: 'ğŸ’¡ '; font-weight: 700; }

    .warn-box {
        background: var(--warning-light);
        border: 1px solid #fcd34d;
        border-radius: 10px;
        padding: 14px 16px;
        font-size: 13px;
        color: #92400e;
        margin: 14px 0;
        line-height: 1.65;
    }
    .warn-box::before { content: 'âš ï¸ '; font-weight: 700; }

    .success-box {
        background: var(--success-light);
        border: 1px solid #6ee7b7;
        border-radius: 10px;
        padding: 14px 16px;
        font-size: 13px;
        color: #065f46;
        margin: 14px 0;
        line-height: 1.65;
    }
    .success-box::before { content: 'âœ… '; font-weight: 700; }

    .table-doc {
        width: 100%;
        border-collapse: collapse;
        font-size: 13.5px;
        margin: 14px 0;
    }
    .table-doc th {
        background: var(--bg-subtle);
        padding: 10px 14px;
        text-align: left;
        font-weight: 600;
        border: 1px solid var(--border);
        font-size: 12.5px;
    }
    .table-doc td {
        padding: 10px 14px;
        border: 1px solid var(--border);
        color: var(--text-secondary);
    }

    .nav-buttons {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 8px;
        flex-wrap: wrap;
    }
</style>
{% endblock %}

{% block content %}
<div class="doc-wrap">

    <!-- Ä°Ã§indekiler -->
    <div class="doc-toc">
        <h3>ğŸ“‹ Ä°Ã§indekiler</h3>
        <ol>
            <li><a href="#genel-bakis">Genel BakÄ±ÅŸ</a></li>
            <li><a href="#jira-adimlar">Jira'da YapÄ±lacaklar</a></li>
            <li><a href="#api-token">API Token OluÅŸturma</a></li>
            <li><a href="#proje-anahtari">Proje AnahtarÄ±nÄ± Bulma</a></li>
            <li><a href="#site-adimlar">Sitemizde YapÄ±lacaklar</a></li>
            <li><a href="#baglanti-test">BaÄŸlantÄ±yÄ± Test Etme</a></li>
            <li><a href="#kayitlar">KayÄ±tlar SayfasÄ±</a></li>
            <li><a href="#sorun-giderme">Sorun Giderme</a></li>
        </ol>
    </div>

    <!-- 1. Genel BakÄ±ÅŸ -->
    <div class="doc-section" id="genel-bakis">
        <h2>1ï¸âƒ£ Genel BakÄ±ÅŸ</h2>
        <p>
            Bu Ã¶zellik, Jira'daki mevcut projenize baÄŸlanarak kayÄ±tlarÄ± (issue) doÄŸrudan bu platformdan
            gÃ¶rÃ¼ntÃ¼lemenize olanak tanÄ±r. BaÄŸlantÄ±, Atlassian'Ä±n resmi <strong>REST API v3</strong>'Ã¼
            kullanÄ±larak gerÃ§ekleÅŸtirilir.
        </p>
        <h3>NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h3>
        <p>
            Sistem, Jira hesabÄ±nÄ±z iÃ§in oluÅŸturulan <strong>API Token</strong> aracÄ±lÄ±ÄŸÄ±yla gÃ¼venli bir
            ÅŸekilde Jira'ya baÄŸlanÄ±r. Bu token, yalnÄ±zca okuma iÅŸlemleri iÃ§in gereklidir; hiÃ§bir veri
            deÄŸiÅŸtirilmez. Kimlik bilgileri, sadece bu sunucunun veritabanÄ±nda saklanÄ±r ve Ã¼Ã§Ã¼ncÃ¼ taraflarla
            paylaÅŸÄ±lmaz.
        </p>
        <div class="success-box">
            Desteklenen Jira tÃ¼rÃ¼: <strong>Atlassian Cloud</strong> (Ã–rn: <code>sirket.atlassian.net</code>).
            Åirket iÃ§i (Server/Data Center) kurulumlar iÃ§in URL formatÄ± aynÄ±dÄ±r ancak kendi sunucu adresinizi kullanÄ±rsÄ±nÄ±z.
        </div>
    </div>

    <!-- 2. Jira'da YapÄ±lacaklar -->
    <div class="doc-section" id="jira-adimlar">
        <h2>2ï¸âƒ£ Jira'da YapÄ±lacaklar</h2>
        <p>BaÄŸlantÄ± kurmadan Ã¶nce Jira tarafÄ±nda iki bilgiye ihtiyacÄ±nÄ±z var:</p>
        <ul>
            <li>Atlassian hesabÄ±nÄ±za ait <strong>API Token</strong></li>
            <li>BaÄŸlanmak istediÄŸiniz Jira projesinin <strong>Proje AnahtarÄ±</strong> (Project Key)</li>
        </ul>
        <div class="tip-box">
            Bu iÅŸlemleri yapmak iÃ§in Jira'ya eriÅŸim yetkiniz ve projeye Ã¼yeliÄŸiniz olmasÄ± gerekir.
        </div>
    </div>

    <!-- 3. API Token OluÅŸturma -->
    <div class="doc-section" id="api-token">
        <h2>3ï¸âƒ£ API Token OluÅŸturma (Jira'da)</h2>
        <p>API Token, Jira hesabÄ±nÄ±za ÅŸifrenizi paylaÅŸmadan gÃ¼venli eriÅŸim saÄŸlar.</p>

        <ul class="step-list">
            <li>
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Atlassian hesabÄ±nÄ±za giriÅŸ yapÄ±n</strong>
                    <span>
                        TarayÄ±cÄ±nÄ±zda
                        <a href="https://id.atlassian.com/manage-profile/security/api-tokens" target="_blank" rel="noopener" style="color:var(--primary);">
                            id.atlassian.com/manage-profile/security/api-tokens
                        </a>
                        adresine gidin. Gerekirse e-posta ve ÅŸifrenizle giriÅŸ yapÄ±n.
                    </span>
                </div>
            </li>
            <li>
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>"Create API token" butonuna tÄ±klayÄ±n</strong>
                    <span>SayfanÄ±n Ã¼st kÄ±smÄ±ndaki mavi butona tÄ±klayÄ±n.</span>
                </div>
            </li>
            <li>
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>Tokene bir isim verin</strong>
                    <span>
                        AÃ§Ä±lan dialog kutusuna bir isim yazÄ±n (Ã¶rn: <code>Destek Merkezi</code>) ve
                        <em>Create</em> butonuna tÄ±klayÄ±n.
                    </span>
                </div>
            </li>
            <li>
                <div class="step-num">4</div>
                <div class="step-content">
                    <strong>Tokeni kopyalayÄ±n</strong>
                    <span>
                        OluÅŸturulan token ekranda gÃ¶rÃ¼ntÃ¼lenecektir. <strong>Bu token bir daha gÃ¶sterilmez</strong>,
                        bu yÃ¼zden hemen kopyalayÄ±p gÃ¼venli bir yere kaydedin.
                    </span>
                </div>
            </li>
        </ul>

        <div class="warn-box">
            API tokenÄ± kimseyle paylaÅŸmayÄ±n. Token, Jira hesabÄ±nÄ±za tam eriÅŸim saÄŸlar. Ä°htiyaÃ§ duymazsanÄ±z veya
            tehlikeye girdiyse Atlassian hesabÄ± sayfasÄ±ndan iptal edin.
        </div>
    </div>

    <!-- 4. Proje AnahtarÄ±nÄ± Bulma -->
    <div class="doc-section" id="proje-anahtari">
        <h2>4ï¸âƒ£ Proje AnahtarÄ±nÄ± Bulma</h2>
        <p>
            Her Jira projesinin benzersiz bir kÄ±sa kodu (Project Key) vardÄ±r.
            Ã–rneÄŸin: <code>SUP</code>, <code>IT</code>, <code>HELP</code>, <code>DEV</code>.
        </p>
        <ul class="step-list">
            <li>
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Jira'da projenize gidin</strong>
                    <span>Sol menÃ¼den "Projects" seÃ§in ve baÄŸlanmak istediÄŸiniz projeye tÄ±klayÄ±n.</span>
                </div>
            </li>
            <li>
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>Proje AyarlarÄ±'nÄ± aÃ§Ä±n</strong>
                    <span>Sol alt kÃ¶ÅŸede "Project settings" (Proje ayarlarÄ±) baÄŸlantÄ±sÄ±na tÄ±klayÄ±n.</span>
                </div>
            </li>
            <li>
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>Key (Anahtar) alanÄ±nÄ± bulun</strong>
                    <span>
                        "Details" (AyrÄ±ntÄ±lar) sekmesinde "Key" alanÄ±nÄ± gÃ¶receksiniz.
                        Bu deÄŸer proje anahtarÄ±nÄ±zdÄ±r (Ã¶rn: <code>SUP</code>).
                        AyrÄ±ca Jira URL'sinde kayÄ±t numaralarÄ±ndan da anlaÅŸÄ±lÄ±r: <code>SUP-123</code>.
                    </span>
                </div>
            </li>
        </ul>
        <div class="tip-box">
            Proje anahtarÄ±nÄ± bulmak iÃ§in en hÄ±zlÄ± yÃ¶ntem: Herhangi bir Jira kaydÄ±nÄ±n baÅŸlÄ±ÄŸÄ±na bakÄ±n.
            <code>SUP-42</code> gibi gÃ¶rÃ¼nÃ¼yorsa proje anahtarÄ±nÄ±z <code>SUP</code>'tur.
        </div>
    </div>

    <!-- 5. Sitemizde YapÄ±lacaklar -->
    <div class="doc-section" id="site-adimlar">
        <h2>5ï¸âƒ£ Sitemizde YapÄ±lacaklar</h2>
        <p>
            Jira'dan gerekli bilgileri aldÄ±ktan sonra <strong>Jira AyarlarÄ±</strong> sayfasÄ±nÄ± doldurun:
        </p>

        <table class="table-doc">
            <thead>
                <tr>
                    <th>Alan</th>
                    <th>AÃ§Ä±klama</th>
                    <th>Ã–rnek</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Jira Alan URL'si</strong></td>
                    <td>Jira sitenizin tam adresi (sonda / olmadan)</td>
                    <td><code>https://sirket.atlassian.net</code></td>
                </tr>
                <tr>
                    <td><strong>E-posta Adresi</strong></td>
                    <td>Atlassian hesabÄ±nÄ±zda kayÄ±tlÄ± e-posta</td>
                    <td><code>ali@sirket.com</code></td>
                </tr>
                <tr>
                    <td><strong>Proje AnahtarÄ±</strong></td>
                    <td>Jira proje kodu (bÃ¼yÃ¼k harf)</td>
                    <td><code>SUP</code></td>
                </tr>
                <tr>
                    <td><strong>API Token</strong></td>
                    <td>Atlassian hesabÄ±ndan oluÅŸturulan token</td>
                    <td><code>ATATT3xFf...</code></td>
                </tr>
            </tbody>
        </table>

        <ul class="step-list">
            <li>
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Jira AyarlarÄ± sayfasÄ±nÄ± aÃ§Ä±n</strong>
                    <span>Sol menÃ¼den "Jira AyarlarÄ±" seÃ§eneÄŸine tÄ±klayÄ±n veya Ã¼st saÄŸdaki butona basÄ±n.</span>
                </div>
            </li>
            <li>
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>Formu doldurun</strong>
                    <span>YukarÄ±daki tabloya gÃ¶re tÃ¼m alanlarÄ± eksiksiz doldurun.</span>
                </div>
            </li>
            <li>
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>"BaÄŸlan" butonuna tÄ±klayÄ±n</strong>
                    <span>
                        Sistem otomatik olarak Jira'ya baÄŸlanÄ±p kimlik doÄŸrulamasÄ±nÄ± test eder.
                        BaÅŸarÄ±lÄ± ise "KayÄ±tlar" sayfasÄ±na yÃ¶nlendirilirsiniz.
                    </span>
                </div>
            </li>
        </ul>
    </div>

    <!-- 6. BaÄŸlantÄ±yÄ± Test Etme -->
    <div class="doc-section" id="baglanti-test">
        <h2>6ï¸âƒ£ BaÄŸlantÄ±yÄ± Test Etme</h2>
        <p>
            Form gÃ¶nderildiÄŸinde sistem otomatik olarak
            <code>GET /rest/api/3/myself</code> endpoint'ini Ã§aÄŸÄ±rarak kimlik doÄŸrular.
        </p>
        <ul>
            <li><strong>âœ… BaÅŸarÄ±lÄ±:</strong> "Jira baÄŸlantÄ±sÄ± baÅŸarÄ±yla kaydedildi" mesajÄ± gÃ¶rÃ¼nÃ¼r
                ve KayÄ±tlar sayfasÄ±na yÃ¶nlendirilirsiniz.</li>
            <li><strong>âŒ 401 HatasÄ±:</strong> E-posta veya API Token hatalÄ±. Kontrol edin.</li>
            <li><strong>âŒ BaÄŸlantÄ± HatasÄ±:</strong> URL hatalÄ± ya da Jira'ya eriÅŸilemiyor.</li>
        </ul>
        <div class="code-block">
# Jira REST API test (terminal ile manuel test)
curl -u "e-posta@sirket.com:API_TOKEN" \
     -H "Accept: application/json" \
     "https://sirket.atlassian.net/rest/api/3/myself"</div>
        <div class="tip-box">
            BaÄŸlantÄ± baÅŸarÄ±lÄ±ysa JSON formatÄ±nda hesap bilgilerinizi dÃ¶nen bir yanÄ±t gÃ¶rÃ¼rsÃ¼nÃ¼z.
        </div>
    </div>

    <!-- 7. KayÄ±tlar SayfasÄ± -->
    <div class="doc-section" id="kayitlar">
        <h2>7ï¸âƒ£ KayÄ±tlar SayfasÄ±</h2>
        <p>
            BaÄŸlantÄ± kurulduktan sonra <strong>KayÄ±tlar</strong> sayfasÄ± ÅŸu bilgileri listeler:
        </p>
        <ul>
            <li>ğŸ”‘ <strong>KayÄ±t AnahtarÄ±</strong> â€“ Jira'daki kayda doÄŸrudan link (Ã¶rn: SUP-42)</li>
            <li>ğŸ“‹ <strong>BaÅŸlÄ±k</strong> â€“ KayÄ±t Ã¶zeti ve tipi (Bug, Task, Story, Epic)</li>
            <li>ğŸ”µ <strong>Durum</strong> â€“ To Do / In Progress / Done</li>
            <li>ğŸŸ¡ <strong>Ã–ncelik</strong> â€“ Highest, High, Medium, Low, Lowest</li>
            <li>ğŸ‘¤ <strong>Atanan</strong> â€“ GÃ¶reve atanan kiÅŸi</li>
            <li>ğŸ“… <strong>GÃ¼ncelleme Tarihi</strong></li>
        </ul>
        <h3>Filtreleme ve Arama</h3>
        <ul>
            <li><strong>Metin Arama</strong> â€“ BaÅŸlÄ±k veya iÃ§erikte arama yapabilirsiniz.</li>
            <li><strong>Durum Filtresi</strong> â€“ To Do, In Progress veya Done durumlarÄ±na gÃ¶re filtreleyin.</li>
            <li><strong>Sayfalama</strong> â€“ Her sayfada 20 kayÄ±t gÃ¶sterilir.</li>
        </ul>
        <div class="tip-box">
            KayÄ±t anahtarÄ±na (Ã¶rn: <code>SUP-42</code>) tÄ±kladÄ±ÄŸÄ±nÄ±zda Jira'daki kayda yeni sekmede
            doÄŸrudan ulaÅŸabilirsiniz.
        </div>
    </div>

    <!-- 8. Sorun Giderme -->
    <div class="doc-section" id="sorun-giderme">
        <h2>8ï¸âƒ£ Sorun Giderme</h2>

        <h3>401 Unauthorized (Yetkisiz EriÅŸim)</h3>
        <ul>
            <li>E-posta adresi yanlÄ±ÅŸ girilmiÅŸ olabilir. Atlassian hesabÄ±nÄ±zdaki e-postayla aynÄ± olmalÄ±.</li>
            <li>API Token yanlÄ±ÅŸ kopyalanmÄ±ÅŸ olabilir. Yeni bir token oluÅŸturun.</li>
            <li>Token iptal edilmiÅŸ olabilir. Atlassian hesabÄ±ndan kontrol edin.</li>
        </ul>

        <h3>BaÄŸlantÄ± HatasÄ± / Zaman AÅŸÄ±mÄ±</h3>
        <ul>
            <li>URL formatÄ±nÄ± kontrol edin: <code>https://sirket.atlassian.net</code> (sonda <code>/</code> olmadan)</li>
            <li>Ä°nternet baÄŸlantÄ±sÄ±nÄ± ve Jira'nÄ±n eriÅŸilebilir olduÄŸunu doÄŸrulayÄ±n.</li>
            <li>Åirket gÃ¼venlik duvarÄ± (firewall) Atlassian'Ä± engelliyor olabilir.</li>
        </ul>

        <h3>KayÄ±tlar SayfasÄ± BoÅŸ GÃ¶rÃ¼nÃ¼yor</h3>
        <ul>
            <li>Proje AnahtarÄ±'nÄ±n doÄŸru girildiÄŸini kontrol edin (bÃ¼yÃ¼k harf, boÅŸluksuz).</li>
            <li>Jira hesabÄ±nÄ±zÄ±n bu projeye Ã¼ye olduÄŸunu doÄŸrulayÄ±n.</li>
            <li>Proje gerÃ§ekten kayÄ±t iÃ§eriyor mu? Jira'da kontrol edin.</li>
        </ul>

        <h3>API Ä°zinleri</h3>
        <p>
            BaÄŸlantÄ± iÃ§in gereken minimum izinler:
        </p>
        <table class="table-doc">
            <thead>
                <tr><th>Ä°zin</th><th>Gereklilik</th></tr>
            </thead>
            <tbody>
                <tr><td>Browse Projects (Projeleri GÃ¶rÃ¼ntÃ¼le)</td><td>âœ… Gerekli</td></tr>
                <tr><td>View Issues (KayÄ±tlarÄ± GÃ¶rÃ¼ntÃ¼le)</td><td>âœ… Gerekli</td></tr>
                <tr><td>Edit / Create / Delete Issues</td><td>âŒ Gerekli DeÄŸil</td></tr>
            </tbody>
        </table>
        <div class="tip-box">
            KullanÄ±cÄ±nÄ±n projeye en az <strong>"GÃ¶zlemci" (Viewer)</strong> rolÃ¼ atanmÄ±ÅŸ olmasÄ± yeterlidir.
        </div>
    </div>

    <div class="nav-buttons">
        <a href="{{ url_for('jira_settings_view') }}" class="btn btn-primary">
            âš™ï¸ Jira BaÄŸlantÄ±sÄ±nÄ± YapÄ±landÄ±r
        </a>
        <a href="{{ url_for('jira_kayitlar') }}" class="btn btn-secondary">
            ğŸ« KayÄ±tlara Git
        </a>
    </div>

</div>
{% endblock %}
